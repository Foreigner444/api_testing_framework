# Lesson 6.15: Cookie Authentication with httpx

## A. Concept Overview

### What & Why
**Cookie authentication** uses HTTP cookies to transmit authentication tokens. Essential for testing web APIs and applications that use cookie-based sessions.

### Analogy
Cookies are like wristbands at an amusement parkâ€”received at entrance (login), checked at each ride (request), removed at exit (logout).

---

## B. Code Implementation

```python
import httpx


# httpx automatically handles cookies
client = httpx.Client(base_url="https://api.example.com")

# Login response sets cookies
response = client.post("/login", json={"user": "test", "pass": "secret"})

# Cookies automatically included in next request
profile = client.get("/profile")


# Manual cookie handling
client = httpx.Client(
    base_url="https://api.example.com",
    cookies={"session_id": "abc123xyz"}
)


# Testing cookies
def test_cookie_authentication():
    client = httpx.Client(base_url="https://httpbin.org")
    
    # Set cookie
    client.cookies.set("auth_token", "test_token_123")
    
    # Cookie sent automatically
    response = client.get("/cookies")
    
    assert "auth_token" in response.json()["cookies"]
    assert response.json()["cookies"]["auth_token"] == "test_token_123"
```

---

## C. Connect & Apply

Test cookie-based authentication with httpbin.

---

## D. Common Stumbling Blocks

**Mistake:** Cookies not persisting between requests
**Fix:** Use same Client instance

---

## ðŸŽ¯ Key Takeaways

âœ… httpx automatically manages cookies  
âœ… Login responses set cookies  
âœ… Cookies auto-sent on subsequent requests  
âœ… Use client.cookies to access/modify  

---

## What's Next?

Next: **httpx Cookies and Cookie Jars**!

**Ready to continue?** ðŸš€
