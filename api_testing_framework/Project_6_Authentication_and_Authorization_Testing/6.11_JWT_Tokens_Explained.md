# Lesson 6.11: JWT Tokens Explained

## A. Concept Overview

### What & Why
**JWT (JSON Web Tokens)** are self-contained tokens encoding user information and claims as JSON, signed to prevent tampering. Essential for modern APIsâ€”understand JWT structure to validate tokens, test expiration, and verify claims in your API tests.

### Analogy
A JWT is like a signed concert ticket with your name and seat number printed on it. The signature prevents forgery, the printed info (claims) tells who you are and what you can access, all in one tamper-proof package.

---

## B. Code Implementation

```python
import jwt
from datetime import datetime, timedelta


# JWT Structure: header.payload.signature

# Example JWT
token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"

# Decode without verification (inspect only)
decoded = jwt.decode(token, options={"verify_signature": False})
print(decoded)
# {'sub': '1234567890', 'name': 'John Doe', 'iat': 1516239022}


# Create JWT
payload = {
    "sub": "user123",  # Subject (user ID)
    "name": "John Doe",
    "email": "john@example.com",
    "exp": datetime.utcnow() + timedelta(hours=1),  # Expiration
    "iat": datetime.utcnow(),  # Issued at
    "roles": ["user", "admin"]
}

secret = "your-secret-key"
token = jwt.encode(payload, secret, algorithm="HS256")


# Decode and verify
decoded = jwt.decode(token, secret, algorithms=["HS256"])
print(f"User: {decoded['name']}")
```

---

## C. Connect & Apply

```bash
pip install PyJWT

python -c "
import jwt
token = jwt.encode({'user': 'test'}, 'secret', algorithm='HS256')
print(f'Token: {token}')
decoded = jwt.decode(token, 'secret', algorithms=['HS256'])
print(f'Decoded: {decoded}')
"
```

---

## D. Common Stumbling Blocks

**Mistake:** Forgetting to specify algorithms in decode
**Fix:** Always specify `algorithms=["HS256"]` parameter

---

## ðŸŽ¯ Key Takeaways

âœ… JWT = header.payload.signature  
âœ… Payload contains claims (user data)  
âœ… Signature prevents tampering  
âœ… Self-contained (no server lookup needed)  

---

## What's Next?

Next: **Decoding and Validating JWT**!

**Ready to continue?** ðŸš€
