# Lesson 6.7: Custom Auth Classes in httpx

## A. Concept Overview

### What & Why
**Custom Auth classes** let you implement any authentication scheme by subclassing httpx.Auth. Essential for APIs with non-standard auth methods.

### Analogy
Custom auth is like a universal adapterâ€”when standard plugs don't fit, you build a custom adapter that does.

---

## B. Code Implementation

```python
from httpx import Auth, Request, Response
import httpx
import hashlib
import time


class SignedRequestAuth(Auth):
    """Custom auth that signs requests with HMAC."""
    
    def __init__(self, access_key: str, secret_key: str):
        self.access_key = access_key
        self.secret_key = secret_key
    
    def auth_flow(self, request: Request):
        # Add timestamp
        timestamp = str(int(time.time()))
        request.headers["X-Timestamp"] = timestamp
        
        # Create signature
        message = f"{request.method}{request.url.path}{timestamp}"
        signature = hashlib.sha256(
            f"{message}{self.secret_key}".encode()
        ).hexdigest()
        
        # Add auth headers
        request.headers["X-Access-Key"] = self.access_key
        request.headers["X-Signature"] = signature
        
        yield request


# Usage
auth = SignedRequestAuth(
    access_key="access_123",
    secret_key="secret_xyz"
)

client = httpx.Client(base_url="https://api.example.com", auth=auth)
```

---

## C. Connect & Apply

Create custom auth class for your API's specific requirements.

---

## D. Common Stumbling Blocks

**Mistake:** Not yielding request
**Fix:** Always `yield request` in auth_flow

---

## ðŸŽ¯ Key Takeaways

âœ… Subclass httpx.Auth for custom auth  
âœ… Implement auth_flow method  
âœ… Yield modified request  
âœ… Works with any auth scheme  

---

## What's Next?

Next: **Introduction to OAuth 2.0**!

**Ready to continue?** ðŸš€
