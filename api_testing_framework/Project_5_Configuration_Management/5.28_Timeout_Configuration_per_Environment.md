# Lesson 5.28: Timeout Configuration per Environment

## A. Concept Overview

### What & Why
**Environment-specific timeouts** ensure requests wait appropriately for each environmentâ€”short timeouts in development for fast feedback, longer timeouts in production for reliability under load. Prevents false failures from premature timeouts and excessive waits from too-long timeouts.

### Analogy
Timeouts are like waiting for an elevatorâ€”in a small building (development), you'd wait 30 seconds before taking stairs. In a skyscraper (production), you'd wait 2 minutes because elevators serve many floors and have higher load.

---

## B. Code Implementation

```python
from pydantic import Field
from pydantic_settings import BaseSettings
import httpx


class TimeoutSettings(BaseSettings):
    # Connection timeout
    connect_timeout: float = Field(
        default=5.0,
        description="Time to establish connection"
    )
    
    # Read timeout
    read_timeout: float = Field(
        default=30.0,
        description="Time to wait for response"
    )
    
    # Write timeout
    write_timeout: float = Field(
        default=30.0,
        description="Time to send request"
    )
    
    # Pool timeout
    pool_timeout: float = Field(
        default=5.0,
        description="Time to get connection from pool"
    )


# .env.development (fast feedback)
# CONNECT_TIMEOUT=2.0
# READ_TIMEOUT=10.0
# WRITE_TIMEOUT=10.0
# POOL_TIMEOUT=1.0

# .env.production (reliability)
# CONNECT_TIMEOUT=10.0
# READ_TIMEOUT=60.0
# WRITE_TIMEOUT=60.0
# POOL_TIMEOUT=10.0


def create_client_with_timeouts(settings: TimeoutSettings) -> httpx.Client:
    """Create client with configured timeouts."""
    return httpx.Client(
        timeout=httpx.Timeout(
            connect=settings.connect_timeout,
            read=settings.read_timeout,
            write=settings.write_timeout,
            pool=settings.pool_timeout
        )
    )
```

---

## C. Connect & Apply

```python
settings = TimeoutSettings()
client = create_client_with_timeouts(settings)
```

---

## D. Common Stumbling Blocks

**Mistake:** Same timeout for all operations
**Fix:** Different timeouts for connect, read, write

---

## ðŸŽ¯ Key Takeaways

âœ… **Short timeouts** in dev for fast feedback  
âœ… **Long timeouts** in prod for reliability  
âœ… **Separate timeouts** for connect/read/write  
âœ… **Configure per environment**  

---

## What's Next?

Next: **Authentication Configuration**!

**Ready to continue?** ðŸš€
