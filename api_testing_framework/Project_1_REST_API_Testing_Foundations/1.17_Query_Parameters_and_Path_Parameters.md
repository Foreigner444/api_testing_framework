# Lesson 1.17: Query Parameters and Path Parameters

## A. Concept Overview

### What & Why
**Parameters** pass data in URLs - path parameters identify resources (/users/{id}), query parameters filter/customize (?sort=name&limit=10). They're essential for dynamic API requests.

### Analogy
Parameters are like giving directions: Path parameters ("go to building 5, floor 3, room 42") identify exact location. Query parameters ("sort by price, show first 10 items, color=blue") customize what you see there.

---

## B. Path Parameters

```python
import httpx

# Path parameters in URL
user_id = 1
response = httpx.get(f"https://jsonplaceholder.typicode.com/users/{user_id}")

post_id = 5
response = httpx.get(f"https://jsonplaceholder.typicode.com/posts/{post_id}")

# Multiple path parameters
user_id = 1
post_id = 10
url = f"https://api.example.com/users/{user_id}/posts/{post_id}"
```

---

## C. Query Parameters

```python
import httpx

# Method 1: String concatenation (not recommended)
response = httpx.get("https://jsonplaceholder.typicode.com/posts?userId=1")

# Method 2: params dict (recommended)
params = {"userId": 1}
response = httpx.get("https://jsonplaceholder.typicode.com/posts", params=params)

# Multiple params
params = {
    "userId": 1,
    "sort": "title",
    "order": "asc"
}
response = httpx.get("https://jsonplaceholder.typicode.com/posts", params=params)
```

---

## D. Testing with Parameters

```python
def test_filter_by_user():
    """Test filtering posts by userId."""
    user_id = 1
    
    response = httpx.get(
        "https://jsonplaceholder.typicode.com/posts",
        params={"userId": user_id}
    )
    
    assert response.status_code == 200
    posts = response.json()
    
    # All posts should be from this user
    for post in posts:
        assert post["userId"] == user_id


def test_multiple_query_params():
    """Test multiple query parameters."""
    params = {
        "userId": 1,
        "_limit": 5
    }
    
    response = httpx.get(
        "https://jsonplaceholder.typicode.com/posts",
        params=params
    )
    
    assert response.status_code == 200
    posts = response.json()
    
    # Should be limited to 5
    assert len(posts) <= 5
    
    # Should be from user 1
    for post in posts:
        assert post["userId"] == 1


def test_special_characters_in_params():
    """Test special characters are URL encoded."""
    params = {
        "search": "hello world",  # Space
        "filter": "value&special"  # Special chars
    }
    
    response = httpx.get("https://httpbin.org/get", params=params)
    data = response.json()
    
    # httpx handles encoding automatically
    assert data["args"]["search"] == "hello world"
```

---

## E. Array Parameters

```python
def test_array_parameters():
    """Test sending array values."""
    # Multiple values for same key
    params = {"id": ["1", "2", "3"]}
    
    response = httpx.get("https://httpbin.org/get", params=params)
    data = response.json()
    
    # Check how server receives it
    print(data["args"])
```

---

## F. Combining Path and Query Parameters

```python
def test_path_and_query_combined():
    """Test using both path and query parameters."""
    # Path parameter: user ID
    user_id = 1
    
    # Query parameters: filtering
    params = {"_limit": 5}
    
    url = f"https://jsonplaceholder.typicode.com/users/{user_id}/posts"
    response = httpx.get(url, params=params)
    
    # Note: This specific endpoint may not work on JSONPlaceholder
    # Use posts with userId query instead
    response = httpx.get(
        "https://jsonplaceholder.typicode.com/posts",
        params={"userId": user_id, "_limit": 5}
    )
    
    assert response.status_code == 200
```

---

## G. Key Takeaways

ðŸ”‘ **Path params**: In URL path (/users/{id})  
ðŸ”‘ **Query params**: After ? (?key=value)  
ðŸ”‘ **Use params dict**: httpx handles encoding  
ðŸ”‘ **Multiple params**: & separates them  
ðŸ”‘ **Special chars**: Auto-encoded by httpx  
ðŸ”‘ **Arrays**: Multiple values for same key  

---

## H. What's Next?

In **Lesson 1.18: httpx Timeout Configuration**, we'll master timeout handling.

Ready for lesson 1.18? ðŸš€
