# 4.4 Generating Emails and Phone Numbers

## A. Concept Overview

### What & Why
Emails and phone numbers are critical for API testing, especially for user registration, authentication, and communication features. Faker provides multiple methods to generate realistic email addresses and phone numbers in various formats, from safe test emails to international phone numbers.

### Analogy
Think of Faker's email and phone methods like **different phone plans and email services**.

- **Safe email**: Like a temporary burner email for testing - `safe_email()` uses example.com
- **Free email**: Like Gmail, Yahoo - `free_email()` uses real providers
- **Company email**: Like corporate email - `company_email()` uses company domains
- **Phone numbers**: Like different carriers with different formats

Each serves a different testing purpose!

---

## B. Code Implementation

### File Path: `examples/emails_phones.py`

```python
"""Comprehensive examples for emails and phone numbers."""
from faker import Faker

fake = Faker()

print("=" * 70)
print("EMAILS AND PHONE NUMBERS - COMPREHENSIVE GUIDE")
print("=" * 70)

# ==================== EMAIL GENERATION ====================
print("\nðŸ“§ EMAIL TYPES:")
print(f"Email: {fake.email()}")
print(f"Safe email: {fake.safe_email()}")
print(f"Free email: {fake.free_email()}")
print(f"Company email: {fake.company_email()}")

print("\nðŸ“§ ASCII EMAIL (no unicode):")
print(f"ASCII email: {fake.ascii_email()}")
print(f"ASCII safe email: {fake.ascii_safe_email()}")
print(f"ASCII free email: {fake.ascii_free_email()}")
print(f"ASCII company email: {fake.ascii_company_email()}")

# ==================== USERNAME ====================
print("\nðŸ‘¤ USERNAMES:")
print(f"Username: {fake.user_name()}")

# ==================== PHONE NUMBERS ====================
print("\nðŸ“± PHONE NUMBERS:")
print(f"Phone number: {fake.phone_number()}")
print(f"MSISDN: {fake.msisdn()}")

# ==================== CUSTOM EMAIL ====================
print("\nðŸ“§ CUSTOM EMAIL WITH DOMAIN:")
domain = "testcompany.com"
username = fake.user_name()
custom_email = f"{username}@{domain}"
print(f"Custom email: {custom_email}")

# ==================== VARIATIONS ====================
print("\nðŸ”„ GENERATING VARIATIONS:")
print("10 different emails:")
for i in range(10):
    print(f"  {i+1}. {fake.email()}")

print("\n" + "=" * 70)
```

---

### File Path: `tests/test_emails_phones.py`

```python
"""Tests for email and phone number generation."""
import pytest
import re
from faker import Faker


# ==================== EMAIL TESTS ====================

def test_basic_email():
    """Test basic email generation."""
    fake = Faker()
    
    email = fake.email()
    
    # Should be valid email format
    assert isinstance(email, str)
    assert "@" in email
    assert "." in email.split("@")[1]  # Domain has dot
    
    # Should match email pattern
    email_pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    assert re.match(email_pattern, email)
    
    print(f"âœ… Email generated: {email}")


def test_safe_email():
    """Test safe email generation."""
    fake = Faker()
    
    safe_email = fake.safe_email()
    
    # Should use safe domains
    safe_domains = ["example.com", "example.org", "example.net"]
    domain = safe_email.split("@")[1]
    
    assert domain in safe_domains
    
    print(f"âœ… Safe email: {safe_email} (domain: {domain})")


def test_free_email():
    """Test free email generation."""
    fake = Faker()
    
    free_email = fake.free_email()
    
    # Should use free email providers
    free_domains = [
        "gmail.com", "yahoo.com", "hotmail.com", 
        "outlook.com", "aol.com", "icloud.com"
    ]
    
    domain = free_email.split("@")[1]
    
    # Domain should be one of the free providers
    # Note: Faker might add more over time
    assert "@" in free_email
    
    print(f"âœ… Free email: {free_email}")


def test_company_email():
    """Test company email generation."""
    fake = Faker()
    
    company_email = fake.company_email()
    
    # Should have @ and domain
    assert "@" in company_email
    assert "." in company_email.split("@")[1]
    
    # Should NOT be a free email domain
    free_domains = ["gmail.com", "yahoo.com", "hotmail.com"]
    domain = company_email.split("@")[1]
    assert domain not in free_domains
    
    print(f"âœ… Company email: {company_email}")


def test_ascii_email():
    """Test ASCII email (no unicode characters)."""
    fake = Faker()
    
    ascii_email = fake.ascii_email()
    
    # Should only contain ASCII characters
    assert ascii_email.isascii()
    assert "@" in ascii_email
    
    print(f"âœ… ASCII email: {ascii_email}")


def test_username():
    """Test username generation."""
    fake = Faker()
    
    username = fake.user_name()
    
    # Should be valid username format
    assert isinstance(username, str)
    assert len(username) > 0
    
    # Typically lowercase letters, maybe dots/underscores
    # Should not contain @
    assert "@" not in username
    
    print(f"âœ… Username: {username}")


def test_multiple_unique_emails():
    """Test generating multiple unique emails."""
    fake = Faker()
    
    emails = [fake.email() for _ in range(100)]
    
    # All should be valid
    assert all("@" in email for email in emails)
    
    # Most should be unique
    unique_emails = set(emails)
    uniqueness_ratio = len(unique_emails) / len(emails)
    
    assert uniqueness_ratio > 0.95  # At least 95% unique
    
    print(f"âœ… Generated {len(emails)} emails!")
    print(f"   Unique: {len(unique_emails)} ({uniqueness_ratio:.1%})")


# ==================== PHONE NUMBER TESTS ====================

def test_basic_phone():
    """Test basic phone number generation."""
    fake = Faker()
    
    phone = fake.phone_number()
    
    # Should be non-empty string
    assert isinstance(phone, str)
    assert len(phone) > 0
    
    # Should contain digits
    assert any(char.isdigit() for char in phone)
    
    print(f"âœ… Phone number: {phone}")


def test_msisdn():
    """Test MSISDN generation (international mobile number)."""
    fake = Faker()
    
    msisdn = fake.msisdn()
    
    # Should be numeric string
    assert isinstance(msisdn, str)
    assert msisdn.isdigit()
    
    # Should be reasonable length (typically 10-15 digits)
    assert 10 <= len(msisdn) <= 15
    
    print(f"âœ… MSISDN: {msisdn}")


def test_phone_number_variety():
    """Test phone number format variety."""
    fake = Faker()
    
    phones = [fake.phone_number() for _ in range(10)]
    
    # All should be non-empty
    assert all(len(p) > 0 for p in phones)
    
    # All should contain digits
    assert all(any(c.isdigit() for c in p) for p in phones)
    
    print(f"âœ… Generated {len(phones)} phone numbers!")
    for i, phone in enumerate(phones, 1):
        print(f"   {i}. {phone}")


# ==================== PRACTICAL COMBINATIONS ====================

def test_contact_info_generation():
    """Test generating complete contact information."""
    fake = Faker()
    
    contact_info = {
        "name": fake.name(),
        "email": fake.email(),
        "phone": fake.phone_number(),
        "mobile": fake.msisdn(),
        "username": fake.user_name()
    }
    
    # All fields should be present
    assert all(value for value in contact_info.values())
    
    # Email should be valid
    assert "@" in contact_info["email"]
    
    print(f"âœ… Contact info generated!")
    print(f"   Name: {contact_info['name']}")
    print(f"   Email: {contact_info['email']}")
    print(f"   Phone: {contact_info['phone']}")


def test_user_registration_data():
    """Test generating user registration data."""
    fake = Faker()
    
    registration_data = {
        "username": fake.user_name(),
        "email": fake.email(),
        "first_name": fake.first_name(),
        "last_name": fake.last_name(),
        "phone": fake.phone_number(),
        "address": fake.street_address(),
        "city": fake.city(),
        "state": fake.state_abbr(),
        "zipcode": fake.zipcode()
    }
    
    # Validate all fields
    assert all(value for value in registration_data.values())
    
    print(f"âœ… Registration data generated!")
    print(f"   Username: {registration_data['username']}")
    print(f"   Email: {registration_data['email']}")


def test_bulk_email_generation():
    """Test bulk email generation for load testing."""
    fake = Faker()
    
    # Generate 1000 emails
    emails = [fake.email() for _ in range(1000)]
    
    assert len(emails) == 1000
    
    # Check uniqueness
    unique_emails = set(emails)
    uniqueness_ratio = len(unique_emails) / len(emails)
    
    # Should be highly unique
    assert uniqueness_ratio > 0.98
    
    print(f"âœ… Bulk generation: {len(emails)} emails")
    print(f"   Uniqueness: {uniqueness_ratio:.2%}")


def test_custom_domain_emails():
    """Test creating emails with custom domain."""
    fake = Faker()
    
    custom_domain = "mycompany.com"
    
    # Generate 5 emails with custom domain
    emails = [
        f"{fake.user_name()}@{custom_domain}"
        for _ in range(5)
    ]
    
    # All should use custom domain
    assert all(email.endswith(f"@{custom_domain}") for email in emails)
    
    print(f"âœ… Custom domain emails!")
    for email in emails:
        print(f"   {email}")


def test_email_parts():
    """Test extracting email components."""
    fake = Faker()
    
    email = fake.email()
    
    # Split into parts
    local, domain = email.split("@")
    
    assert len(local) > 0
    assert len(domain) > 0
    assert "." in domain
    
    print(f"âœ… Email parts: {local} @ {domain}")
```

---

## D. Connect & Apply

### How to Test It

```bash
pytest tests/test_emails_phones.py -v -s
```

### Expected Result

```
tests/test_emails_phones.py::test_basic_email PASSED
âœ… Email generated: jennifer.martinez@example.com

tests/test_emails_phones.py::test_safe_email PASSED
âœ… Safe email: test@example.com

tests/test_emails_phones.py::test_bulk_email_generation PASSED
âœ… Bulk generation: 1000 emails
   Uniqueness: 99.80%

======================== 18 passed in 1.23s =========================
```

---

## E. Email Types Quick Reference

| Method | Domain Type | Use Case |
|--------|-------------|----------|
| `email()` | Random | General testing |
| `safe_email()` | example.com | Safe for any environment |
| `free_email()` | gmail.com, yahoo.com | Realistic personal emails |
| `company_email()` | Company domains | Business scenarios |
| `ascii_email()` | ASCII only | Systems with unicode issues |

---

## F. What You've Learned

âœ… Different email generation methods  
âœ… Safe vs free vs company emails  
âœ… ASCII emails for compatibility  
âœ… Username generation  
âœ… Phone number generation  
âœ… MSISDN for international mobiles  
âœ… Bulk email generation  
âœ… Custom domain emails  
âœ… Practical contact info patterns  

---

## G. What's Next?

In **Lesson 4.5 (Generating Dates and Times)**, we'll learn:
- Date ranges and constraints
- Birthdays and timestamps
- Time zones and formats
- Date math with Faker

Keep building that test data toolkit! ðŸŽ‰

---

**Ready for the next lesson?**
